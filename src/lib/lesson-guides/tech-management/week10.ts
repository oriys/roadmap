import type { LessonGuide } from "../types"
import type { QuizQuestion } from "@/lib/types"

export const week10Guides: Record<string, LessonGuide> = {
    "tm-10-1": {
        lessonId: "tm-10-1",
        background: [
            "【Team Topologies 核心】Matthew Skelton 和 Manuel Pais 在《Team Topologies》中提出了四种基本团队类型，旨在优化团队间的认知负荷和协作效率。这是现代软件组织设计的重要参考框架。",
            "【Stream-Aligned Team】流对齐团队是组织的主力，直接对齐业务价值流。他们端到端负责特定业务领域，具有完整的交付能力，是最常见的团队类型。",
            "【Enabling Team】赋能团队帮助其他团队掌握新技能或技术。他们不直接交付业务功能，而是通过培训、辅导和临时支持来提升其他团队的能力。",
            "【Platform Team】平台团队构建和维护内部平台，提供自服务能力给其他团队使用。他们的目标是降低流对齐团队的认知负荷，让业务团队专注于业务逻辑。",
            "【Complicated-Subsystem Team】复杂子系统团队负责需要特殊专业知识的子系统。当某个领域复杂度过高，不适合由流对齐团队全面掌握时，就需要这种专家团队。"
        ],
        keyDifficulties: [
            "【团队类型选择】决定一个团队应该是什么类型需要深入分析业务需求、技术复杂度和组织成熟度。错误的类型选择会导致效率低下。",
            "【认知负荷平衡】每个团队能承载的认知负荷有限。过多的职责或技术栈会导致团队疲于奔命，需要通过团队拓扑来合理分配。",
            "【交互模式选择】三种交互模式（协作、X-as-a-Service、辅导）各有适用场景，需要根据团队成熟度和业务需求动态调整。",
            "【康威定律应用】康威定律指出'系统设计反映组织沟通结构'。逆康威定律建议先设计目标架构，再调整组织结构来支撑。"
        ],
        handsOnPath: [
            "1. 团队盘点：绘制当前组织的团队拓扑图，标记每个团队的类型和主要职责",
            "2. 交互模式分析：识别团队之间的主要交互模式，评估是否存在过度协作或依赖",
            "3. 认知负荷评估：与团队讨论他们承担的认知负荷，识别过载的信号",
            "4. 目标状态设计：根据业务目标和技术战略，设计理想的团队拓扑",
            "5. 阅读《Team Topologies》第1-4章，理解四种团队类型和三种交互模式"
        ],
        selfCheck: [
            "你能否清晰地说明组织中每个团队的类型和职责边界？",
            "团队之间的交互模式是否明确？是否存在模糊地带导致效率损失？",
            "平台团队是否真正提供自服务能力，还是变成了瓶颈？",
            "流对齐团队是否具备端到端交付能力，还是过度依赖其他团队？",
            "组织的团队结构是否与目标系统架构对齐？"
        ],
        extensions: [
            "研究逆康威定律及其在组织设计中的应用",
            "了解 Spotify 模型（Squads, Tribes, Chapters, Guilds）与 Team Topologies 的关系",
            "学习如何进行团队认知负荷评估",
            "探索团队拓扑在微服务架构中的应用"
        ],
        sourceUrls: [
            "https://teamtopologies.com/book",
            "https://www.amazon.com/Team-Topologies-Organizing-Business-Technology/dp/1942788819",
            "https://martinfowler.com/bliki/ConwaysLaw.html"
        ]
    },
    "tm-10-2": {
        lessonId: "tm-10-2",
        background: [
            "【依赖类型】跨团队依赖可分为三类：知识依赖（需要其他团队的专业知识）、资源依赖（需要其他团队的人力或工具）、顺序依赖（需要其他团队先完成某些工作）。",
            "【三种交互模式】Team Topologies 定义了三种团队交互模式：1) 协作模式（Collaboration）——两个团队紧密合作；2) X-as-a-Service——一个团队提供服务，另一个消费；3) 辅导模式（Facilitating）——一个团队帮助另一个团队提升能力。",
            "【依赖可视化】使用依赖地图或价值流图来可视化团队间的依赖关系，识别瓶颈和风险点。这是有效管理依赖的第一步。",
            "【协调成本】每增加一个跨团队依赖，协调成本就会指数级增长。高效组织的目标是最小化必要的跨团队依赖。",
            "【接口契约】明确的接口契约（API 契约、SLA、沟通协议）是减少跨团队摩擦的关键。模糊的边界会导致反复沟通和误解。"
        ],
        keyDifficulties: [
            "【依赖识别】很多依赖是隐性的，需要主动挖掘。定期的依赖审计可以帮助发现这些隐藏的耦合。",
            "【优先级冲突】不同团队有不同的优先级，依赖请求可能被搁置。需要建立跨团队优先级对齐机制。",
            "【沟通过载】过多的跨团队沟通会消耗大量时间。需要找到高效沟通和自主性之间的平衡。",
            "【风险传递】一个团队的延期会连锁影响下游团队。需要建立风险预警和缓冲机制。"
        ],
        handsOnPath: [
            "1. 依赖地图绘制：列出你的团队对其他团队的所有依赖，按紧迫程度和重要性排序",
            "2. 接口清晰化：与依赖团队明确接口契约，包括响应时间、变更通知等",
            "3. 依赖会议：建立定期的跨团队依赖同步会议，提前识别风险",
            "4. 消除依赖实验：选择一个高摩擦依赖，探索如何通过技术或组织手段消除它",
            "5. 阅读《Team Topologies》第5-6章，理解团队交互模式"
        ],
        selfCheck: [
            "你能列出团队当前的主要跨团队依赖吗？哪些是阻塞性的？",
            "依赖团队的响应时间是否可预期？是否有明确的 SLA？",
            "当依赖方延期时，你有什么备选方案？",
            "过去一个月因为跨团队依赖导致的延期有多少次？",
            "团队之间的接口契约是否明确并被遵守？"
        ],
        extensions: [
            "学习价值流图（Value Stream Mapping）识别跨团队瓶颈",
            "研究微服务架构中的服务间依赖管理",
            "了解特性团队 vs 组件团队的权衡",
            "探索 API 契约测试（Contract Testing）"
        ],
        sourceUrls: [
            "https://teamtopologies.com/key-concepts-content/team-interaction-modes",
            "https://www.amazon.com/Accelerate-Software-Performing-Technology-Organizations/dp/1942788339",
            "https://martinfowler.com/articles/break-monolith-into-microservices.html"
        ]
    },
    "tm-10-3": {
        lessonId: "tm-10-3",
        background: [
            "【平台思维定义】平台思维是将内部能力作为产品来构建和运营的方法论。内部用户是你的客户，需要同样关注他们的体验和需求。",
            "【内部产品特征】优秀的内部平台具有三个特征：1) 自服务——用户无需等待平台团队即可使用；2) 标准化——提供一致的接口和体验；3) 可扩展——能够随业务增长而扩展。",
            "【产品思维应用】将产品管理方法应用于内部平台：用户研究、路线图规划、迭代发布、反馈收集。内部用户的需求同样需要被认真对待。",
            "【铺路 vs 造墙】好的平台是'铺路'（Paved Roads）——提供最佳实践路径但不强制；差的平台是'造墙'——限制用户的选择而不提供替代方案。",
            "【平台即产品】Evan Bottcher 提出'平台即产品'理念：平台团队应该像产品团队一样运营，关注用户采纳率、满意度和价值交付。"
        ],
        keyDifficulties: [
            "【用户采纳】内部平台最大的挑战是获得用户采纳。强制使用会引起抵触，需要通过价值证明来吸引用户。",
            "【资源投入】平台建设需要持续投入，但难以直接量化业务价值。需要建立有效的度量和沟通机制。",
            "【需求平衡】不同团队有不同的需求，平台团队需要在标准化和灵活性之间找到平衡。",
            "【技术债务】平台如果设计不当，会成为全组织的技术债务来源。需要高标准的技术决策。"
        ],
        handsOnPath: [
            "1. 内部平台审计：盘点组织现有的内部平台或共享服务，评估其成熟度",
            "2. 用户访谈：与内部平台的用户交流，了解他们的痛点和需求",
            "3. 自服务评估：检查现有平台的自服务程度，识别需要人工干预的环节",
            "4. 度量建立：为内部平台建立使用度量（采纳率、满意度、自服务比例）",
            "5. 阅读 Evan Bottcher 的'Platform as a Product'文章"
        ],
        selfCheck: [
            "组织的内部平台是否真正提供自服务能力？",
            "平台团队是否定期收集和响应用户反馈？",
            "内部平台的使用率和满意度如何？有没有度量？",
            "平台是'铺路'还是'造墙'？用户是否有选择的余地？",
            "平台团队是否具备产品思维，还是只关注技术实现？"
        ],
        extensions: [
            "研究 Netflix、Spotify 等公司的内部平台实践",
            "了解开发者体验（Developer Experience, DevEx）的概念",
            "学习内部开源（Inner Source）模式",
            "探索平台工程（Platform Engineering）的最新趋势"
        ],
        sourceUrls: [
            "https://martinfowler.com/articles/talk-about-platforms.html",
            "https://teamtopologies.com/key-concepts-content/what-is-a-thinnest-viable-platform-tvp",
            "https://www.thoughtworks.com/radar/techniques/platform-engineering-product-teams"
        ]
    }
}

export const week10Quizzes: Record<string, QuizQuestion[]> = {
    "tm-10-1": [
        {
            id: "tm-10-1-q1",
            question: "Team Topologies 定义的四种基本团队类型是什么？",
            options: [
                "开发团队、测试团队、运维团队、产品团队",
                "Stream-Aligned、Enabling、Platform、Complicated-Subsystem",
                "前端团队、后端团队、数据团队、基础设施团队",
                "核心团队、支持团队、外包团队、管理团队"
            ],
            answer: 1,
            rationale: "Team Topologies 定义了四种团队类型：Stream-Aligned（流对齐）、Enabling（赋能）、Platform（平台）、Complicated-Subsystem（复杂子系统）。"
        },
        {
            id: "tm-10-1-q2",
            question: "Stream-Aligned Team（流对齐团队）的主要特征是什么？",
            options: [
                "负责构建内部平台",
                "直接对齐业务价值流，端到端负责特定业务领域",
                "帮助其他团队掌握新技能",
                "负责高度复杂的技术子系统"
            ],
            answer: 1,
            rationale: "流对齐团队直接对齐业务价值流，端到端负责特定业务领域，具有完整的交付能力。"
        },
        {
            id: "tm-10-1-q3",
            question: "Enabling Team（赋能团队）的职责是什么？",
            options: [
                "直接交付业务功能",
                "帮助其他团队掌握新技能或技术",
                "维护生产环境",
                "管理项目进度"
            ],
            answer: 1,
            rationale: "赋能团队帮助其他团队掌握新技能或技术，通过培训、辅导和临时支持来提升其他团队的能力。"
        },
        {
            id: "tm-10-1-q4",
            question: "Platform Team（平台团队）的目标是什么？",
            options: [
                "直接交付客户功能",
                "降低流对齐团队的认知负荷，提供自服务能力",
                "管理所有技术决策",
                "负责招聘和培训"
            ],
            answer: 1,
            rationale: "平台团队构建和维护内部平台，提供自服务能力，目标是降低流对齐团队的认知负荷。"
        },
        {
            id: "tm-10-1-q5",
            question: "什么时候需要 Complicated-Subsystem Team（复杂子系统团队）？",
            options: [
                "当团队人数过多时",
                "当某个领域复杂度过高，不适合由流对齐团队全面掌握时",
                "当需要跨时区协作时",
                "当项目预算充足时"
            ],
            answer: 1,
            rationale: "当某个领域复杂度过高，需要特殊专业知识，不适合由流对齐团队全面掌握时，需要复杂子系统团队。"
        },
        {
            id: "tm-10-1-q6",
            question: "康威定律（Conway's Law）的核心含义是什么？",
            options: [
                "系统设计反映组织沟通结构",
                "软件复杂度随时间增长",
                "团队规模应该限制在两个披萨能喂饱的人数",
                "技术债务会指数增长"
            ],
            answer: 0,
            rationale: "康威定律指出'设计系统的组织受限于复制其沟通结构的设计'，即系统设计反映组织沟通结构。"
        },
        {
            id: "tm-10-1-q7",
            question: "Team Topologies 定义的三种团队交互模式是什么？",
            options: [
                "同步、异步、混合",
                "协作、X-as-a-Service、辅导",
                "串行、并行、分布式",
                "拉取、推送、订阅"
            ],
            answer: 1,
            rationale: "Team Topologies 定义了三种交互模式：协作（Collaboration）、X-as-a-Service、辅导（Facilitating）。"
        },
        {
            id: "tm-10-1-q8",
            question: "逆康威定律的建议是什么？",
            options: [
                "让系统架构适应现有组织结构",
                "先设计目标架构，再调整组织结构来支撑",
                "保持组织结构不变",
                "让每个团队自己决定架构"
            ],
            answer: 1,
            rationale: "逆康威定律建议先设计目标系统架构，然后有意识地调整组织结构来支撑这个架构。"
        },
        {
            id: "tm-10-1-q9",
            question: "认知负荷在团队设计中的作用是什么？",
            options: [
                "可以忽略不计",
                "每个团队能承载的认知负荷有限，需要合理分配",
                "只影响新员工",
                "只与技术复杂度相关"
            ],
            answer: 1,
            rationale: "每个团队能承载的认知负荷有限，过多的职责或技术栈会导致团队疲于奔命，需要通过团队拓扑来合理分配。"
        },
        {
            id: "tm-10-1-q10",
            question: "协作模式（Collaboration）最适合什么场景？",
            options: [
                "稳定的服务消费关系",
                "两个团队需要紧密合作探索新领域或解决复杂问题时",
                "日常运维工作",
                "独立交付的项目"
            ],
            answer: 1,
            rationale: "协作模式适合两个团队需要紧密合作的场景，如探索新领域或解决跨领域的复杂问题。"
        },
        {
            id: "tm-10-1-q11",
            question: "《Team Topologies》的作者是谁？",
            options: [
                "Martin Fowler 和 Kent Beck",
                "Matthew Skelton 和 Manuel Pais",
                "Eric Evans 和 Vaughn Vernon",
                "Sam Newman 和 Chris Richardson"
            ],
            answer: 1,
            rationale: "《Team Topologies》由 Matthew Skelton 和 Manuel Pais 合著。"
        },
        {
            id: "tm-10-1-q12",
            question: "如何判断团队类型选择是否正确？",
            options: [
                "看团队人数",
                "分析业务需求、技术复杂度和组织成熟度",
                "看预算分配",
                "看管理层偏好"
            ],
            answer: 1,
            rationale: "决定团队类型需要深入分析业务需求、技术复杂度和组织成熟度，错误的类型选择会导致效率低下。"
        }
    ],
    "tm-10-2": [
        {
            id: "tm-10-2-q1",
            question: "跨团队依赖可以分为哪三类？",
            options: [
                "技术依赖、业务依赖、管理依赖",
                "知识依赖、资源依赖、顺序依赖",
                "内部依赖、外部依赖、混合依赖",
                "强依赖、弱依赖、可选依赖"
            ],
            answer: 1,
            rationale: "跨团队依赖可分为：知识依赖（专业知识）、资源依赖（人力或工具）、顺序依赖（先完成某些工作）。"
        },
        {
            id: "tm-10-2-q2",
            question: "X-as-a-Service 交互模式的特点是什么？",
            options: [
                "两个团队紧密合作",
                "一个团队提供服务，另一个团队消费",
                "一个团队帮助另一个团队提升能力",
                "所有团队共同决策"
            ],
            answer: 1,
            rationale: "X-as-a-Service 模式下，一个团队提供标准化服务，另一个团队作为消费者使用，减少协调成本。"
        },
        {
            id: "tm-10-2-q3",
            question: "为什么依赖可视化是管理依赖的第一步？",
            options: [
                "满足合规要求",
                "帮助识别团队间的依赖关系、瓶颈和风险点",
                "方便汇报给管理层",
                "用于绩效考核"
            ],
            answer: 1,
            rationale: "使用依赖地图或价值流图来可视化团队间的依赖关系，可以帮助识别瓶颈和风险点。"
        },
        {
            id: "tm-10-2-q4",
            question: "跨团队依赖增加时，协调成本如何变化？",
            options: [
                "线性增长",
                "保持不变",
                "指数级增长",
                "逐渐减少"
            ],
            answer: 2,
            rationale: "每增加一个跨团队依赖，协调成本就会指数级增长，这是高效组织最小化依赖的原因。"
        },
        {
            id: "tm-10-2-q5",
            question: "减少跨团队摩擦的关键是什么？",
            options: [
                "减少团队数量",
                "明确的接口契约（API契约、SLA、沟通协议）",
                "增加项目经理",
                "使用相同的技术栈"
            ],
            answer: 1,
            rationale: "明确的接口契约是减少跨团队摩擦的关键，模糊的边界会导致反复沟通和误解。"
        },
        {
            id: "tm-10-2-q6",
            question: "辅导模式（Facilitating）适用于什么场景？",
            options: [
                "日常服务消费",
                "一个团队帮助另一个团队提升特定能力",
                "两个团队竞争资源",
                "紧急项目交付"
            ],
            answer: 1,
            rationale: "辅导模式适用于一个团队（通常是赋能团队）帮助另一个团队提升特定能力的场景。"
        },
        {
            id: "tm-10-2-q7",
            question: "隐性依赖的问题是什么？",
            options: [
                "容易被识别",
                "需要主动挖掘，否则会导致意外风险",
                "不影响项目进度",
                "自动会被解决"
            ],
            answer: 1,
            rationale: "很多依赖是隐性的，需要主动挖掘，否则会在关键时刻导致意外延期或问题。"
        },
        {
            id: "tm-10-2-q8",
            question: "当不同团队有不同优先级时会发生什么？",
            options: [
                "不会产生冲突",
                "依赖请求可能被搁置，需要建立跨团队优先级对齐机制",
                "项目自动延期",
                "管理层会介入解决"
            ],
            answer: 1,
            rationale: "不同团队有不同的优先级，依赖请求可能被搁置，需要建立跨团队优先级对齐机制。"
        },
        {
            id: "tm-10-2-q9",
            question: "处理依赖团队延期风险的方法是什么？",
            options: [
                "等待对方完成",
                "建立风险预警和缓冲机制，准备备选方案",
                "向上级投诉",
                "取消依赖需求"
            ],
            answer: 1,
            rationale: "一个团队的延期会连锁影响下游团队，需要建立风险预警和缓冲机制，并准备备选方案。"
        },
        {
            id: "tm-10-2-q10",
            question: "高效组织在依赖管理上的目标是什么？",
            options: [
                "增加跨团队协作",
                "最小化必要的跨团队依赖",
                "集中所有决策权",
                "统一所有团队的技术栈"
            ],
            answer: 1,
            rationale: "高效组织的目标是最小化必要的跨团队依赖，因为每个依赖都会增加协调成本。"
        },
        {
            id: "tm-10-2-q11",
            question: "定期依赖审计的作用是什么？",
            options: [
                "满足审计合规",
                "帮助发现隐藏的团队间耦合",
                "评估团队绩效",
                "分配预算"
            ],
            answer: 1,
            rationale: "定期的依赖审计可以帮助发现隐性的团队间耦合，提前识别和解决问题。"
        },
        {
            id: "tm-10-2-q12",
            question: "价值流图（Value Stream Mapping）在依赖管理中的作用是什么？",
            options: [
                "计算项目成本",
                "识别跨团队瓶颈和价值流动中的浪费",
                "分配工作任务",
                "评估代码质量"
            ],
            answer: 1,
            rationale: "价值流图可以帮助识别跨团队瓶颈和价值流动中的浪费，是优化依赖的有效工具。"
        }
    ],
    "tm-10-3": [
        {
            id: "tm-10-3-q1",
            question: "平台思维的核心理念是什么？",
            options: [
                "构建最新技术的平台",
                "将内部能力作为产品来构建和运营",
                "减少平台团队规模",
                "外包平台建设"
            ],
            answer: 1,
            rationale: "平台思维是将内部能力作为产品来构建和运营，内部用户是你的客户，需要关注他们的体验和需求。"
        },
        {
            id: "tm-10-3-q2",
            question: "优秀内部平台的三个特征是什么？",
            options: [
                "便宜、快速、简单",
                "自服务、标准化、可扩展",
                "安全、稳定、高性能",
                "开源、免费、灵活"
            ],
            answer: 1,
            rationale: "优秀的内部平台具有三个特征：自服务（无需等待）、标准化（一致接口）、可扩展（随业务增长）。"
        },
        {
            id: "tm-10-3-q3",
            question: "'铺路'（Paved Roads）vs '造墙' 的区别是什么？",
            options: [
                "铺路更贵，造墙更便宜",
                "铺路提供最佳实践但不强制，造墙限制选择不提供替代",
                "铺路适合大公司，造墙适合小公司",
                "铺路是临时方案，造墙是永久方案"
            ],
            answer: 1,
            rationale: "好的平台'铺路'提供最佳实践路径但不强制；差的平台'造墙'限制用户选择而不提供替代方案。"
        },
        {
            id: "tm-10-3-q4",
            question: "内部平台面临的最大挑战是什么？",
            options: [
                "技术实现难度",
                "获得用户采纳",
                "预算限制",
                "团队规模"
            ],
            answer: 1,
            rationale: "内部平台最大的挑战是获得用户采纳，强制使用会引起抵触，需要通过价值证明来吸引用户。"
        },
        {
            id: "tm-10-3-q5",
            question: "'平台即产品'理念的提出者是谁？",
            options: [
                "Martin Fowler",
                "Evan Bottcher",
                "Kent Beck",
                "Eric Evans"
            ],
            answer: 1,
            rationale: "Evan Bottcher 提出'平台即产品'理念，强调平台团队应该像产品团队一样运营。"
        },
        {
            id: "tm-10-3-q6",
            question: "如何证明内部平台的价值？",
            options: [
                "强调技术先进性",
                "建立使用度量（采纳率、满意度、自服务比例）",
                "增加平台功能",
                "扩大团队规模"
            ],
            answer: 1,
            rationale: "平台建设难以直接量化业务价值，需要建立使用度量如采纳率、满意度、自服务比例来证明价值。"
        },
        {
            id: "tm-10-3-q7",
            question: "平台团队需要在什么之间找到平衡？",
            options: [
                "成本和收益",
                "标准化和灵活性",
                "速度和质量",
                "规模和效率"
            ],
            answer: 1,
            rationale: "不同团队有不同需求，平台团队需要在标准化（一致性）和灵活性（满足特殊需求）之间找到平衡。"
        },
        {
            id: "tm-10-3-q8",
            question: "平台设计不当会带来什么问题？",
            options: [
                "只影响平台团队",
                "成为全组织的技术债务来源",
                "容易被替换",
                "不会有长期影响"
            ],
            answer: 1,
            rationale: "平台如果设计不当，会成为全组织的技术债务来源，影响所有使用平台的团队。"
        },
        {
            id: "tm-10-3-q9",
            question: "自服务能力对平台意味着什么？",
            options: [
                "平台团队不需要工作",
                "用户无需等待平台团队即可使用平台功能",
                "用户需要自己维护平台",
                "减少平台团队人数"
            ],
            answer: 1,
            rationale: "自服务意味着用户无需等待平台团队的人工干预，可以自主使用平台提供的能力。"
        },
        {
            id: "tm-10-3-q10",
            question: "产品思维如何应用于内部平台？",
            options: [
                "只关注技术实现",
                "用户研究、路线图规划、迭代发布、反馈收集",
                "照搬外部产品的做法",
                "由管理层决定功能"
            ],
            answer: 1,
            rationale: "将产品管理方法应用于内部平台：用户研究、路线图规划、迭代发布、反馈收集。"
        },
        {
            id: "tm-10-3-q11",
            question: "开发者体验（Developer Experience, DevEx）与平台的关系是什么？",
            options: [
                "无关",
                "平台应该关注提升内部开发者的使用体验",
                "只有外部产品需要关注",
                "是平台的副产品"
            ],
            answer: 1,
            rationale: "优秀的内部平台应该关注开发者体验，提升内部开发者使用平台的效率和满意度。"
        },
        {
            id: "tm-10-3-q12",
            question: "内部开源（Inner Source）模式的特点是什么？",
            options: [
                "将内部代码开源到公网",
                "在组织内部应用开源协作模式，允许跨团队贡献",
                "只使用开源软件",
                "禁止使用商业软件"
            ],
            answer: 1,
            rationale: "内部开源是在组织内部应用开源协作模式，允许不同团队对共享代码库进行贡献。"
        }
    ]
}
